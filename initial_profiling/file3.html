<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for master</title><link rel="stylesheet" href="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">master (1 call, 3436.553 sec)</span><br/><i>Generated 22-Dec-2015 12:45:21 using cpu time.</i><br/>function in file /Users/qw2192/Desktop/forQuanli/master.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/> No parent <div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line539">539</a></td><td class="td-linebottomrt"><pre>syn(hh,j) = randomsample(phimj...</pre></td><td class="td-linebottomrt">56800000</td><td class="td-linebottomrt">817.769 s</td><td class="td-linebottomrt" class="td-linebottomrt">23.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=24 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line461">461</a></td><td class="td-linebottomrt"><pre>syn(hh,j) = randomsample(phimj...</pre></td><td class="td-linebottomrt">17100000</td><td class="td-linebottomrt">276.702 s</td><td class="td-linebottomrt" class="td-linebottomrt">8.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line538">538</a></td><td class="td-linebottomrt"><pre>phimj = reshape(phi((hhindexh-...</pre></td><td class="td-linebottomrt">56800000</td><td class="td-linebottomrt">242.422 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line534">534</a></td><td class="td-linebottomrt"><pre>memberindexhh = randomsample(w...</pre></td><td class="td-linebottomrt">11360000</td><td class="td-linebottomrt">164.157 s</td><td class="td-linebottomrt" class="td-linebottomrt">4.8%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line387">387</a></td><td class="td-linebottomrt"><pre>syn(hh,j) = randomsample(phimj...</pre></td><td class="td-linebottomrt">9700000</td><td class="td-linebottomrt">161.920 s</td><td class="td-linebottomrt" class="td-linebottomrt">4.7%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">1773.583 s</td><td class="td-linebottomrt">51.6%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=52 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">3436.553 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file12.html">randomsample</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">111138900</td><td class="td-linebottomrt">322.520 s</td><td class="td-linebottomrt">9.4%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=9 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file14.html">sortrows</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4950000</td><td class="td-linebottomrt">218.932 s</td><td class="td-linebottomrt">6.4%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file11.html">samplezHHwithHHnewv1_2HHvar</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">25</td><td class="td-linebottomrt">3.715 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file8.html">gamrnd</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">77050</td><td class="td-linebottomrt">3.311 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file4.html">hist</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">77</td><td class="td-linebottomrt">2.256 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file7.html">betarnd</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">14977</td><td class="td-linebottomrt">1.508 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file1.html">unique</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">52</td><td class="td-linebottomrt">0.867 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file13.html">samplezmemberv1</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">25</td><td class="td-linebottomrt">0.197 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file17.html">checkingconstraints_size4_sorted_part1</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">284</td><td class="td-linebottomrt">0.187 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file19.html">checkingconstraints_size4_sorted_part3</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">284</td><td class="td-linebottomrt">0.099 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file18.html">checkingconstraints_size4_sorted_part2</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">284</td><td class="td-linebottomrt">0.079 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file16.html">checkingconstraints_size3_sorted</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">114</td><td class="td-linebottomrt">0.049 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file15.html">checkingconstraints_size2_sorted</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">97</td><td class="td-linebottomrt">0.020 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file6.html">randsample</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">2882.804 s</td><td class="td-linebottomrt">83.9%</td><td class="td-linebottomrt"><img src="file:////Applications/MATLAB_R2015a.app/toolbox/matlab/codetools/private/one-pixel.gif" width=84 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">3436.553 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line1">1</a></td><td class="td-linebottomrt"><span class="mono">The function return value 'dummy' might be unset.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line17">17</a></td><td class="td-linebottomrt"><span class="mono">The variable 'origdata00' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line17">17</a></td><td class="td-linebottomrt"><span class="mono">If 'newdata' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line18">18</a></td><td class="td-linebottomrt"><span class="mono">'i' produces a value that might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line30">30</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'sizeACSdata' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line67">67</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'first2data' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line177">177</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'sizeextras' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line197">197</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'HHserial_new' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line408">408</a></td><td class="td-linebottomrt"><span class="mono">Use FIND with the 'first' or 'last' option.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line416">416</a></td><td class="td-linebottomrt"><span class="mono">If 'size2data_to_check_all' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line417">417</a></td><td class="td-linebottomrt"><span class="mono">If 'size2data_to_check_all' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line422">422</a></td><td class="td-linebottomrt"><span class="mono">To improve performance, replace ISEMPTY(FIND(X)) with ISEMPTY(FIND( X, 1 )).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line427">427</a></td><td class="td-linebottomrt"><span class="mono">If 'extras_size2_old1' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line484">484</a></td><td class="td-linebottomrt"><span class="mono">Use FIND with the 'first' or 'last' option.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line492">492</a></td><td class="td-linebottomrt"><span class="mono">If 'size3data_to_check_all' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line493">493</a></td><td class="td-linebottomrt"><span class="mono">If 'size3data_to_check_all' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line498">498</a></td><td class="td-linebottomrt"><span class="mono">To improve performance, replace ISEMPTY(FIND(X)) with ISEMPTY(FIND( X, 1 )).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line503">503</a></td><td class="td-linebottomrt"><span class="mono">If 'extras_size3_old1' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line568">568</a></td><td class="td-linebottomrt"><span class="mono">Use FIND with the 'first' or 'last' option.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line576">576</a></td><td class="td-linebottomrt"><span class="mono">If 'size4data_to_check_all' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line577">577</a></td><td class="td-linebottomrt"><span class="mono">If 'size4data_to_check_all' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line582">582</a></td><td class="td-linebottomrt"><span class="mono">To improve performance, replace ISEMPTY(FIND(X)) with ISEMPTY(FIND( X, 1 )).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line587">587</a></td><td class="td-linebottomrt"><span class="mono">If 'extras_size4_old1' is an indexed variable, performance can be improved using logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line619">619</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line620">620</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line636">636</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'SSorig' might be unused.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">638</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">164</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">474</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">474</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">0</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">100.00 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table id="FunctionListingTable"><tr style="height:20px;"><th><pre><span style="color:#FF0000;">time</span> </pre></th><th><pre><span style="color:#0000FF;">calls</span> </pre></th><th class="leftAligned" COLSPAN=2><pre><span> line</span></pre></th></tr><tr><a name="Line1"></a><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   1</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">function dummy = master()</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   2</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">   3</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">size234alldata = load('ACShouseholddata_size234all.mat'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">   4</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">newdata = size234alldata.newdata; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   5</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">   6</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHindex = <a href="file1.html">unique</a>(newdata(:,1));  </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.08 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">   7</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">SSfull = <a href="file4.html">hist</a>(newdata(:,1),HHindex);  </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   8</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">   9</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.05 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  10</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">randindex = <a href="file6.html">randsample</a>(length(SSfull),10000); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  11</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">SS = SSfull(randindex); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  12</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  13</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">totalcount = 10000; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  14</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">origdata00 = zeros(1,8); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  15</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for i=1:totalcount </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 19.74 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  16</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    index_i = find(newdata(:,1)==randindex(i)); </span><br/></pre></td></tr><tr><a name="Line17"></a><td><pre><span style="color: #FF0000">  1.53 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  17</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    origdata00 = [origdata00;newdata(index_i,:)]; </span><br/></pre></td></tr><tr><a name="Line18"></a><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  18</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    i; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  19</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  20</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  21</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">origdata0 = [origdata00(2:length(origdata00),:),zeros(length(origdata00)-1,1)]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  22</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  23</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for i=1:totalcount </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.25 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  24</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    origdata0((sum(SS(1:i))-SS(i)+1):(sum(SS(1:i))),1) = i; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.26 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  25</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    origdata0((sum(SS(1:i))-SS(i)+1):(sum(SS(1:i))),9) = SS(i); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  26</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  27</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  28</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ACSdatasample = origdata0; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  29</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">sizeACSdata1 = size(ACSdatasample); </span><br/></pre></td></tr><tr><a name="Line30"></a><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  30</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">sizeACSdata = sizeACSdata1(1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  31</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  32</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ACSsize2_count = sum(SS==2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  33</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ACSsize3_count = sum(SS==3); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  34</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ACSsize4_count = sum(SS==4); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  35</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%{</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  36</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">ACSdatasample_try = ACSdatasample;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  37</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">[Y,I]=sort(ACSdatasample_try(:,1));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  38</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">ACSdatasample=ACSdatasample_try(I,:); %use the column indices from sort() to sort all columns of A.</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  39</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%}</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  40</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  41</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHindex = <a href="file1.html">unique</a>(ACSdatasample(:,1)); % serial from 1 to n=23331, total 10000 households </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  42</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">SS = <a href="file4.html">hist</a>(ACSdatasample(:,1),HHindex); % sizes of each HH </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  43</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  44</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% SizeSerial = [HHindex,SS];</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  45</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  46</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for i=1:10000 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.24 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  47</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    ACSdatasample(sum(SS(1:(i-1)))+1:sum(SS(1:i)),1) = i; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  48</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  49</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  50</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% variables: HHindex 1, pernum 2, sex 3, race 4, ethn 5, age 6, relate 7(ind level) ownership 8 (binary, HH level)</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  51</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[n_s,p] = size(ACSdatasample); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  52</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nn = size(SS); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  53</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">n = nn(2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  54</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">p = p-4; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  55</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ACS = ACSdatasample; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  56</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  57</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">data = ACS(:,3:7); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  58</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHdatafull = ACS(:,8:9); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  59</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHdataorig = zeros(n,2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  60</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for i=1:n </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.12 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  61</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    HHdataorig(i,:) = HHdatafull(sum(SS(1:i-1))+1,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">  10000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  62</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  63</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  64</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHdata1 = HHdataorig(:,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  65</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHdata2 = HHdataorig(:,2)-1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  66</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">origdata = ACS; </span><br/></pre></td></tr><tr><a name="Line67"></a><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  67</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">first2data = ACS(:,1:2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  68</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  69</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHserial = ACS(:,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  70</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  71</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% variables: HHindex 1, pernum 2, sex 3, race 4, ethn 5, age 6, relate</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  72</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">% 7(ind level) ownership 8 (binary, HH level) household size </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  73</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">d = [2,9,5,94,12]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  74</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">dHH1 = 2; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  75</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">dHH2 = 3; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  76</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">maxd = max(d); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  77</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  78</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  79</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%---global parameters---%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  80</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  81</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%nrun=10000; burn=8000; thin=10; %50;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  82</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  83</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nrun=25; burn=20; thin=1; %50; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  84</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">eff.sam=(nrun-burn)/thin; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  85</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  86</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">K=40;%5 %50;                       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  87</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">L=15; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  88</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  89</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">aa=0.25; ab=0.25;                  % gamma hyperparameters for alpha </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  90</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ba=0.25; bb=0.25; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  91</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%---define output files---%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  92</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">alphaout = zeros(nrun,1);  </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  93</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">betaout = zeros(nrun,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  94</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">piout = zeros(eff.sam,K);  </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  95</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">wout = zeros(eff.sam,K,L); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  96</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nout = zeros(nrun,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  97</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">n_sout = zeros(nrun,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  98</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">size2extrasize = zeros(nrun,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  99</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">size3extrasize = zeros(nrun,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 100</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">size4extrasize = zeros(nrun,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 101</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%kout = zeros(eff.sam,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 102</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%lout = zeros(eff.sam,1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 103</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">z_HH_save = zeros(nrun,n_s); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 104</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">z_member_save = zeros(nrun,n_s); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 105</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">elapsed_time = zeros(1,nrun); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 106</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">newphiout = zeros(eff.sam,maxd*p,K*L); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 107</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">lambda1out = zeros(eff.sam,K,dHH1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 108</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">lambda2out = zeros(eff.sam,K,dHH2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 109</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%---initial values---%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 110</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 111</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">alpha=1;        % hyperparameters for stick-breaking weights </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 112</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">beta=1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 113</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 114</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">phi=zeros(K*L,p,maxd);      % cell probabilities </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 115</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 116</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for l=1:L </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     15 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 117</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for j=1:p </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     75 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 118</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for c=1:d(j) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.08 </span></pre></td><td><pre><span style="color: #0000FF">   1830 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 119</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        phi(l,j,c)=sum(data(:,j)==c)/n_s; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1830 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 120</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     75 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 121</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     15 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 122</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 123</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 124</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for k=1:(K-1) </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     39 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 125</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    phi((k*L+1):(k*L+L),:,:) = phi(1:L,:,:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     39 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 126</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 127</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 128</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">lambda1 = zeros(K,dHH1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 129</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for c=1:dHH1 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 130</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    lambda1(:,c) = sum(HHdata1==c)/n; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 131</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 132</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 133</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">lambda2 = zeros(K,dHH2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 134</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for c=1:dHH2 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 135</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    lambda2(:,c) = sum(HHdata2==c)/n; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      3 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 136</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 137</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 138</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.27 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 139</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">u=[<a href="file7.html">betarnd</a>(1,alpha,[K-1,1]);1]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 140</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">pi=zeros(K,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 141</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">pi(1:K)=u.*cumprod([1;1-u(1:K-1)]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 142</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 143</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 144</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">v=[<a href="file7.html">betarnd</a>(1,beta,[K,L-1]),ones(K,1)]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 145</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">w=zeros(K,L); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 146</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">v1 = (v(1,:))'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 147</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">w(1,1:L)=v1.*cumprod([1;1-v1(1:L-1)]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 148</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for k=1:K </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     40 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 149</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    v1 = (v(k,:))'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     40 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 150</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    w(k,1:L)=v1.*cumprod([1;1-v1(1:L-1)]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     40 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 151</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 152</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 153</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%profile on</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 154</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%%%%---Blocked sampler---%%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 155</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for i = 1:nrun     </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.17 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 156</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       tic;    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 157</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %% update zHH</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 158</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %%% to work in C++, consider make phi into a 2-d matrix maxd*p-by-K*L</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 159</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       newphi = zeros(maxd*p,K*L); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 160</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       for e = 1:K*L </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.09 </span></pre></td><td><pre><span style="color: #0000FF">  15000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 161</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           newphimatrix = reshape(phi(e,:,:),p,maxd); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.10 </span></pre></td><td><pre><span style="color: #0000FF">  15000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 162</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           for j = 1:p </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.47 </span></pre></td><td><pre><span style="color: #0000FF">  75000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 163</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">               newphi(maxd*(j-1)+1:maxd*j,e) = newphimatrix(j,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.17 </span></pre></td><td><pre><span style="color: #0000FF">  75000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 164</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.05 </span></pre></td><td><pre><span style="color: #0000FF">  15000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 165</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 166</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 167</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       if (i==1) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 168</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           data_full = origdata; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 169</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           HHdata1 = HHdataorig(:,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 170</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           HHdata2 = HHdataorig(:,2)-1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 171</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.05 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 172</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_size2 = extras_size2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.05 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 173</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_size3 = extras_size3; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.21 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 174</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_size4 = extras_size4; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.71 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 175</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras = [trueextras_size2;trueextras_size3;trueextras_size4]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 176</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           sizeextras1 = size(trueextras); </span><br/></pre></td></tr><tr><a name="Line177"></a><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 177</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           sizeextras = sizeextras1(1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.53 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 178</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_HHindex = <a href="file1.html">unique</a>(trueextras(:,1)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.12 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 179</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_SS = <a href="file4.html">hist</a>(trueextras(:,1),trueextras_HHindex);  </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 180</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_ownership = zeros(size_extras_size2_old+size_extras_size3_old+size_extras_size4_old,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 181</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_HH_new = zeros(size_extras_size2_old+size_extras_size3_old+size_extras_size4_old,1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 182</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_HHdatafull = trueextras(:,8); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 183</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras_HH = trueextras(:,9); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 184</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">           </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 185</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           cumSS = cumsum(trueextras_SS); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 186</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           trueextras(1:cumSS(1),1) = 10001; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 187</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           for s=2:size_extras_size2_old+size_extras_size3_old+size_extras_size4_old </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  9.44 </span></pre></td><td><pre><span style="color: #0000FF">4012507 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 188</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                trueextras(cumSS(s-1)+1:cumSS(s),1) = s+10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.75 </span></pre></td><td><pre><span style="color: #0000FF">4012507 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 189</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                trueextras_ownership(s) = trueextras_HHdatafull(cumSS(s)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.05 </span></pre></td><td><pre><span style="color: #0000FF">4012507 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 190</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                z_HH_new(s) = trueextras_HH(cumSS(s)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.03 </span></pre></td><td><pre><span style="color: #0000FF">4012507 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 191</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.68 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 192</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           data_full = [origdata(:,1:8);trueextras(:,1:8)]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 193</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           HHdata1 = [HHdataorig(:,1);trueextras_ownership]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.05 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 194</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           HHdata2 = [HHdataorig(:,2)-1;ones(size_extras_size2_old,1);2*ones(size_extras_size3_old,1);3*ones(size_extras_size4_old,1)]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 195</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 196</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><a name="Line197"></a><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 197</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       HHserial_new = data_full(:,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 198</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.17 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 199</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       data = data_full(:,3:7); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 200</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 201</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %size_data1 = size(data);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 202</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %size_data = size_data1(1);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 203</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       % also need to transpose data</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 204</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       dataT = origdata(:,3:7)'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 205</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.45 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 206</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       HHindex_new = <a href="file1.html">unique</a>(data_full(:,1));  </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.22 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 207</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       SS_new = <a href="file4.html">hist</a>(data_full(:,1),HHindex_new);  </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 208</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 209</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       SSsize_new = size(SS_new); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 210</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       n_new = SSsize_new(2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 211</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       n_s_new0 = size(data); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 212</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       n_s_new = n_s_new0(1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 213</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 214</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       z_HH= zeros(n,1);                   %cluster indicators for household; K </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 215</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       z_member = zeros(n_s,1);             %cluster indicators for household member; L </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 216</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.87 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 217</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       z_HH_prob = <a href="file11.html">samplezHHwithHHnewv1_2HHvar</a>(newphi,dataT,w,pi,SS',K,L,p,maxd,n,HHdata1(1:n),lambda1,HHdata2(1:n),lambda2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 218</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       for h = 1:n </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.83 </span></pre></td><td><pre><span style="color: #0000FF"> 250000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 219</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           zupdateprob_h = z_HH_prob(K*(h-1)+1:K*h); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.84 </span></pre></td><td><pre><span style="color: #0000FF"> 250000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 220</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_HH(h) = <a href="file12.html">randomsample</a>(zupdateprob_h,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.35 </span></pre></td><td><pre><span style="color: #0000FF"> 250000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 221</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 222</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 223</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       z_HH_all = zeros(n_s,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 224</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       cumsumSS = [0 cumsum(SS)]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 225</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       for h = 1:n </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.60 </span></pre></td><td><pre><span style="color: #0000FF"> 250000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 226</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_HH_all(cumsumSS(h)+1:cumsumSS(h+1)) = z_HH(h); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.41 </span></pre></td><td><pre><span style="color: #0000FF"> 250000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 227</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 228</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 229</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       if (i==1) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 230</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_HH_all_every = z_HH_all; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 231</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_HH_every = z_HH; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 232</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 233</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_HH_all_every = [z_HH_all;trueextras(:,9)]; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 234</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_HH_every = [z_HH;z_HH_new]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 235</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 236</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 237</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       disp('zHH updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 238</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %% update zmember</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 239</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %%% to work in C++</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 240</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.34 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 241</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       z_member_prob = <a href="file13.html">samplezmemberv1</a>(newphi,dataT,w,K,L,p,maxd,n_s,z_HH,HHserial); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 242</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 243</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       for m = 1:n_s </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.04 </span></pre></td><td><pre><span style="color: #0000FF"> 668900 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 244</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           zupdateprob_m = z_member_prob(L*(m-1)+1:L*m); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  8.47 </span></pre></td><td><pre><span style="color: #0000FF"> 668900 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 245</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_member(m) = <a href="file12.html">randomsample</a>(zupdateprob_m,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.17 </span></pre></td><td><pre><span style="color: #0000FF"> 668900 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 246</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 247</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 248</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       if (i==1) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 249</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_member_every = z_member; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 250</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       else </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.05 </span></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 251</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">           z_member_every = [z_member;trueextras(:,10)]; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     24 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 252</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 253</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 254</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %toc</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 255</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       disp('zmember updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 256</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %%      </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 257</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % -- update phi-- %</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 258</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %tic;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 259</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        phicount = zeros(K*L,p,maxd); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 260</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for m = 1:n_s_new </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 26.18 </span></pre></td><td><pre><span style="color: #0000FF">14587707 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 261</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            mdata = data(m,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 22.00 </span></pre></td><td><pre><span style="color: #0000FF">14587707 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 262</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for j = 1:p </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 104.64 </span></pre></td><td><pre><span style="color: #0000FF">72938535 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 263</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                mk = z_HH_all_every(m);  </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 104.79 </span></pre></td><td><pre><span style="color: #0000FF">72938535 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 264</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                lk = z_member_every(m); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 105.53 </span></pre></td><td><pre><span style="color: #0000FF">72938535 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 265</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                phicount(L*(mk-1)+lk,j,mdata(j)) = phicount(L*(mk-1)+lk,j,mdata(j))+1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 104.65 </span></pre></td><td><pre><span style="color: #0000FF">72938535 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 266</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 21.73 </span></pre></td><td><pre><span style="color: #0000FF">14587707 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 267</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 268</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 269</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for j = 1:p </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    125 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 270</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            phicountp = reshape(phicount(:,j,:),K*L,maxd); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    125 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 271</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for k = 1:K </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   5000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 272</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                for l = 1:L </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.51 </span></pre></td><td><pre><span style="color: #0000FF">  75000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 273</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    phi1 = <a href="file8.html">gamrnd</a>(phicountp(L*(k-1)+l,1:d(j))+1,1); % variable j, z_HH k, z_member L </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.32 </span></pre></td><td><pre><span style="color: #0000FF">  75000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 274</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    phi11 = bsxfun(@times,phi1(1:d(j)),1./sum(phi1(1:d(j)))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.41 </span></pre></td><td><pre><span style="color: #0000FF">  75000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 275</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    phi(L*(k-1)+l,j,1:d(j)) = phi11; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.18 </span></pre></td><td><pre><span style="color: #0000FF">  75000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 276</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">   5000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 277</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    125 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 278</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 279</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 280</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        phicountcluster = zeros(K,L); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 281</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for k = 1:K </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.88 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 282</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            zh1 = (z_HH_all_every==k); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 283</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for l = 1:L </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 11.45 </span></pre></td><td><pre><span style="color: #0000FF">  15000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 284</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                zh2 = (z_member_every==l); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 17.06 </span></pre></td><td><pre><span style="color: #0000FF">  15000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 285</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                phicountcluster(k,l) = sum(zh1&amp;zh2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.11 </span></pre></td><td><pre><span style="color: #0000FF">  15000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 286</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 287</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 288</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">     </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 289</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        levelk = 1:K; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 290</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        kcount = sum(<a href="file4.html">hist</a>(z_HH_every,levelk),1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 291</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 292</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        disp('phi updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 293</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 294</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %%</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 295</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % -- update lambda -- %</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 296</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %tic;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 297</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        lambda1count = zeros(K,dHH1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 298</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for k = 1:K </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.08 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 299</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lam1 = (z_HH_every==k);  </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 300</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for c = 1:dHH1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.39 </span></pre></td><td><pre><span style="color: #0000FF">   2000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 301</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                value = (HHdata1==c); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.77 </span></pre></td><td><pre><span style="color: #0000FF">   2000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 302</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                lambda1count(k,c) = lambda1count(k,c)+sum(lam1&amp;value); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">   2000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 303</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.19 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 304</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lam11 = <a href="file8.html">gamrnd</a>(lambda1count(k,1:dHH1)+1,1); % variable j, z_HH k, z_member L </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.08 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 305</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lam111 = bsxfun(@times,lam11(1:dHH1),1./sum(lam11(1:dHH1))); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 306</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lambda1(k,1:dHH1) = lam111; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 307</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 308</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 309</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        lambda2count = zeros(K,dHH2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 310</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for k = 1:K </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.82 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 311</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lam1 = (z_HH_every==k);  </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 312</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for c = 1:dHH2 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.43 </span></pre></td><td><pre><span style="color: #0000FF">   3000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 313</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                value = (HHdata2==c); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.10 </span></pre></td><td><pre><span style="color: #0000FF">   3000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 314</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                lambda2count(k,c) = lambda2count(k,c)+sum(lam1&amp;value); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">   3000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 315</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.17 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 316</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lam11 = <a href="file8.html">gamrnd</a>(lambda2count(k,1:dHH2)+1,1); % variable j, z_HH k, z_member L </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 317</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lam111 = bsxfun(@times,lam11(1:dHH2),1./sum(lam11(1:dHH2))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 318</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lambda2(k,1:dHH2) = lam111; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 319</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 320</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 321</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %toc</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 322</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        disp('lambda updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 323</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %%         </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 324</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % -- update pi -- % </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 325</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %tic;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 326</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for k = 1:K-1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.13 </span></pre></td><td><pre><span style="color: #0000FF">    975 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 327</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            u(k) = <a href="file7.html">betarnd</a>(1 + kcount(k),alpha + sum(kcount(k+1:K))); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    975 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 328</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            if u(k)&gt;1-1e-5 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 329</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                u(k)=1-1e-5; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 330</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    975 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 331</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 332</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        u(K) = 1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 333</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 334</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi(1:K)=u.*cumprod([1;1-u(1:K-1)]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 335</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 336</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %toc</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 337</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        disp('pi updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 338</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % -- update w -- %</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 339</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %tic;       </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 340</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for k = 1:K </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 341</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            vk = v(k,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 342</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for l = 1:L-1 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.28 </span></pre></td><td><pre><span style="color: #0000FF">  14000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 343</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                vk(l) = <a href="file7.html">betarnd</a>(1 + phicountcluster(k,l), beta + sum(phicountcluster(k,l+1:L))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">  14000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 344</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if vk(l)&gt;1-1e-5 </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 345</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    vk(l)=1-1e-5; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 346</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">  14000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 347</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                vk(L) = 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">  14000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 348</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 349</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            v(k,:) = vk; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 350</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            w(k,1:L) = vk.*cumprod([1,1-vk(1:L-1)]); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">   1000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 351</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 352</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %toc</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 353</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        disp('w updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 354</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %tic;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 355</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % -- update alpha-- %</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 356</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        alpha = <a href="file8.html">gamrnd</a>(aa + K - 1, 1/(ab - sum(log(1-u(1:K-1))))); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 357</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 358</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % -- update beta -- %</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 359</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        vnew = v(:,1:L-1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 360</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        beta = <a href="file8.html">gamrnd</a>(ba + K*(L-1), 1/(bb - sum(sum(log(1-vnew))))); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 361</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %toc</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 362</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 363</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        disp('alpha beta updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 364</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %tic;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 365</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 366</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %% checking constraints</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 367</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">     %% size2</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.57 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 368</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2data_to_check_all = zeros(150000,8*2+1+2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 369</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2outcome_to_save = zeros(150000,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 370</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2number_of_generation = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 371</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    while (sum(size2outcome_to_save)&lt;=ACSsize2_count) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 372</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2number_of_generation = size2number_of_generation + 1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 373</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %tic;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 374</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2data_to_check = zeros(10000,8*2+1+2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 375</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for m=1:10000 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.26 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 376</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi_size2 = pi.*lambda2(:,1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.69 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 377</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi_size2_renorm = pi_size2./sum(pi_size2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 17.86 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 378</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        hhindexh = <a href="file12.html">randomsample</a>(pi_size2_renorm,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.74 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 379</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,17) = hhindexh; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.28 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 380</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn = zeros(2,p+1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.88 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 381</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for hh = 1:2 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 32.76 </span></pre></td><td><pre><span style="color: #0000FF">1940000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 382</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            memberindexhh = <a href="file12.html">randomsample</a>(w(hhindexh,:),rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.14 </span></pre></td><td><pre><span style="color: #0000FF">1940000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 383</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            size2data_to_check(m,17+hh) = memberindexhh; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 384</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % generating individual level data</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.02 </span></pre></td><td><pre><span style="color: #0000FF">1940000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 385</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for j = 1:p </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 42.62 </span></pre></td><td><pre><span style="color: #0000FF">9700000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 386</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                phimj = reshape(phi((hhindexh-1)*L+memberindexhh,j,1:d(j)),1,d(j)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 161.92 </span></pre></td><td><pre><span style="color: #0000FF">9700000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 387</span> <a name="Line387"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                syn(hh,j) = <a href="file12.html">randomsample</a>(phimj,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 15.80 </span></pre></td><td><pre><span style="color: #0000FF">9700000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 388</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.98 </span></pre></td><td><pre><span style="color: #0000FF">1940000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 389</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 390</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % generating household level data</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.88 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 391</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        lambda1mj = lambda1(hhindexh,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 17.16 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 392</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn(:,p+1) = <a href="file12.html">randomsample</a>(lambda1mj,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 47.16 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 393</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn_sorted = <a href="file14.html">sortrows</a>(syn,5); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.22 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 394</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,3:8) = syn_sorted(1,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.59 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 395</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,11:16) = syn_sorted(2,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.50 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 396</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,1) = m + (size2number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.49 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 397</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,9) = m + (size2number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.29 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 398</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,2) = 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.49 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 399</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,10) = 2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.50 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 400</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size2data_to_check(m,17) = hhindexh; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.41 </span></pre></td><td><pre><span style="color: #0000FF"> 970000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 401</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 402</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 403</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % transpose the data to check</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 404</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2data_to_checkT = size2data_to_check(:,1:16)'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 405</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %toc   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 406</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %mex checkingconstraints_new.cpp       </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.17 </span></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 407</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2outcome = <a href="file15.html">checkingconstraints_size2_sorted</a>(size2data_to_checkT,10000); </span><br/></pre></td></tr><tr><a name="Line408"></a><td><pre><span style="color: #FF0000">  0.28 </span></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 408</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2startindex1 = min(find(size2data_to_check_all(:,1)==0)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 409</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % startindex2 = min(find(outcome_to_save==0));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 410</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2startindex2 = (size2number_of_generation-1)*10000 + 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 411</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2data_to_check_all(size2startindex1:size2startindex1+10000-1,:) = size2data_to_check; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 412</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2outcome_to_save(size2startindex2:(size2startindex2+10000-1)) = size2outcome; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 413</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %sum(outcome)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">     97 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 414</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 415</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><a name="Line416"></a><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 416</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    syndatao_size2_old = size2data_to_check_all(find(size2outcome_to_save==1),:); </span><br/></pre></td></tr><tr><a name="Line417"></a><td><pre><span style="color: #FF0000">  0.29 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 417</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size2_old2 = size2data_to_check_all(find(size2outcome_to_save==0),:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 418</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">   </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 419</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    syndatao_size2 = syndatao_size2_old(1:ACSsize2_count,:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 420</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2exceeding_index = syndatao_size2(ACSsize2_count,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 421</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><a name="Line422"></a><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 422</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    while (isempty(find(extras_size2_old2(:,1)==size2exceeding_index))==1) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     30 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 423</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    	size2exceeding_index = size2exceeding_index - 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     30 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 424</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 425</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size2exceeding_index = size2exceeding_index-10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 426</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size2_old1 = size2data_to_check_all(1:size2exceeding_index,:); </span><br/></pre></td></tr><tr><a name="Line427"></a><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 427</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size2_old = extras_size2_old1(find(size2outcome_to_save(1:size2exceeding_index)==0),:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 428</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 429</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size_extras_size2_old_1 = size(extras_size2_old); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 430</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size_extras_size2_old = size_extras_size2_old_1(1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 431</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 432</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size2 = zeros(2*size_extras_size2_old,8+2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 433</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for s = 1:size_extras_size2_old </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.07 </span></pre></td><td><pre><span style="color: #0000FF"> 646780 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 434</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size2(2*(s-1)+1,1:8) = extras_size2_old(s,1:8); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.94 </span></pre></td><td><pre><span style="color: #0000FF"> 646780 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 435</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size2(2*(s-1)+2,1:8) = extras_size2_old(s,9:16); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.55 </span></pre></td><td><pre><span style="color: #0000FF"> 646780 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 436</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size2((2*(s-1)+1):2*s,9) = extras_size2_old(s,17); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.11 </span></pre></td><td><pre><span style="color: #0000FF"> 646780 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 437</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size2(2*(s-1)+1,10) = extras_size2_old(s,18); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.83 </span></pre></td><td><pre><span style="color: #0000FF"> 646780 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 438</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size2(2*(s-1)+2,10) = extras_size2_old(s,19); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.98 </span></pre></td><td><pre><span style="color: #0000FF"> 646780 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 439</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 440</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 441</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %% size3</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.31 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 442</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3data_to_check_all = zeros(500000,8*3+1+3); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 443</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3outcome_to_save = zeros(500000,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 444</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3number_of_generation = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 445</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    while (sum(size3outcome_to_save)&lt;=ACSsize3_count) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 446</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3number_of_generation = size3number_of_generation + 1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 447</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %tic;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 448</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3data_to_check = zeros(10000,8*3+1+3); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 449</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for m=1:10000 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.94 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 450</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi_size3 = pi.*lambda2(:,2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.03 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 451</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi_size3_renorm = pi_size3./sum(pi_size3); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 19.81 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 452</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        hhindexh = <a href="file12.html">randomsample</a>(pi_size3_renorm,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.02 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 453</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,25) = hhindexh; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.69 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 454</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn = zeros(3,p+1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.47 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 455</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for hh = 1:3 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 55.82 </span></pre></td><td><pre><span style="color: #0000FF">3420000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 456</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            memberindexhh = <a href="file12.html">randomsample</a>(w(hhindexh,:),rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.43 </span></pre></td><td><pre><span style="color: #0000FF">3420000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 457</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            size3data_to_check(m,25+hh) = memberindexhh; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 458</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % generating individual level data</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.53 </span></pre></td><td><pre><span style="color: #0000FF">3420000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 459</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for j = 1:p </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 74.35 </span></pre></td><td><pre><span style="color: #0000FF">17100000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 460</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                phimj = reshape(phi((hhindexh-1)*L+memberindexhh,j,1:d(j)),1,d(j)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 276.70 </span></pre></td><td><pre><span style="color: #0000FF">17100000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 461</span> <a name="Line461"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFD4D4; padding:1px;">                syn(hh,j) = <a href="file12.html">randomsample</a>(phimj,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 27.88 </span></pre></td><td><pre><span style="color: #0000FF">17100000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 462</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.25 </span></pre></td><td><pre><span style="color: #0000FF">3420000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 463</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 464</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % generating household level data</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.50 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 465</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        lambda1mj = lambda1(hhindexh,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 18.03 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 466</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn(:,p+1) = <a href="file12.html">randomsample</a>(lambda1mj,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 55.93 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 467</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn_sorted = <a href="file14.html">sortrows</a>(syn,5); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.30 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 468</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,3:8) = syn_sorted(1,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.21 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 469</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,11:16) = syn_sorted(2,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.00 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 470</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,19:24) = syn_sorted(3,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.66 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 471</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,1) = m + (size2number_of_generation+size3number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.47 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 472</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,9) = m + (size2number_of_generation+size3number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.51 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 473</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,17) = m + (size2number_of_generation+size3number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.62 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 474</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,2) = 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.76 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 475</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,10) = 2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.63 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 476</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size3data_to_check(m,18) = 3; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.61 </span></pre></td><td><pre><span style="color: #0000FF">1140000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 477</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 478</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 479</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % transpose the data to check</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.09 </span></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 480</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3data_to_checkT = size3data_to_check(:,1:24)'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 481</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %toc   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 482</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %mex checkingconstraints_new.cpp       </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.18 </span></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 483</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3outcome = <a href="file16.html">checkingconstraints_size3_sorted</a>(size3data_to_checkT,10000); </span><br/></pre></td></tr><tr><a name="Line484"></a><td><pre><span style="color: #FF0000">  0.59 </span></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 484</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3startindex1 = min(find(size3data_to_check_all(:,1)==0)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 485</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % startindex2 = min(find(outcome_to_save==0));</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 486</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3startindex2 = (size3number_of_generation-1)*10000 + 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 487</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3data_to_check_all(size3startindex1:size3startindex1+10000-1,:) = size3data_to_check; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 488</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3outcome_to_save(size3startindex2:(size3startindex2+10000-1)) = size3outcome; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 489</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %sum(outcome)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.14 </span></pre></td><td><pre><span style="color: #0000FF">    114 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 490</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 491</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><a name="Line492"></a><td><pre><span style="color: #FF0000">  0.12 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 492</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    syndatao_size3_old = size3data_to_check_all(find(size3outcome_to_save==1),:); </span><br/></pre></td></tr><tr><a name="Line493"></a><td><pre><span style="color: #FF0000">  1.20 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 493</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size3_old2 = size3data_to_check_all(find(size3outcome_to_save==0),:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 494</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 495</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    syndatao_size3 = syndatao_size3_old(1:ACSsize3_count,:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 496</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3exceeding_index = syndatao_size3(ACSsize3_count,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 497</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><a name="Line498"></a><td><pre><span style="color: #FF0000">  0.05 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 498</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    while (isempty(find(extras_size3_old2(:,1)==size3exceeding_index))==1) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     27 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 499</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    	size3exceeding_index = size3exceeding_index - 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.10 </span></pre></td><td><pre><span style="color: #0000FF">     27 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 500</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 501</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size3exceeding_index = size3exceeding_index-(1+size2number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.17 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 502</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size3_old1 = size3data_to_check_all(1:size3exceeding_index,:); </span><br/></pre></td></tr><tr><a name="Line503"></a><td><pre><span style="color: #FF0000">  0.09 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 503</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size3_old = extras_size3_old1(find(size3outcome_to_save(1:size3exceeding_index)==0),:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 504</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 505</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size_extras_size3_old_1 = size(extras_size3_old); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 506</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size_extras_size3_old = size_extras_size3_old_1(1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 507</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 508</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size3 = zeros(3*size_extras_size3_old,8+2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 509</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for s = 1:size_extras_size3_old </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.02 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 510</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size3(3*(s-1)+1,1:8) = extras_size3_old(s,1:8); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.05 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 511</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size3(3*(s-1)+2,1:8) = extras_size3_old(s,9:16); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.08 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 512</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size3(3*(s-1)+3,1:8) = extras_size3_old(s,17:24); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.41 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 513</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size3((3*(s-1)+1):3*s,9) = extras_size3_old(s,25); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.52 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 514</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size3(3*(s-1)+1,10) = extras_size3_old(s,26); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.09 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 515</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size3(3*(s-1)+2,10) = extras_size3_old(s,27); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.36 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 516</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size3(3*(s-1)+3,10) = extras_size3_old(s,28); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  1.36 </span></pre></td><td><pre><span style="color: #0000FF"> 934004 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 517</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 518</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 519</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %% size4</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 16.48 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 520</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4data_to_check_all = zeros(5000000,8*4+1+4); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.47 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 521</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4outcome_to_save = zeros(5000000,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 522</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4number_of_generation = 0; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.11 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 523</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    while (sum(size4outcome_to_save)&lt;=ACSsize4_count) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 524</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4number_of_generation = size4number_of_generation + 1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 525</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %tic;</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 526</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4data_to_check = zeros(10000,8*4+1+4); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 527</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for m=1:10000 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.80 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 528</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi_size4 = pi.*lambda2(:,3); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 10.49 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 529</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi_size4_renorm = pi_size4./sum(pi_size4); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 45.38 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 530</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        hhindexh = <a href="file12.html">randomsample</a>(pi_size4_renorm,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.29 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 531</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,33) = hhindexh; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.25 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 532</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn = zeros(4,p+1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.61 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 533</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for hh = 1:4 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 164.16 </span></pre></td><td><pre><span style="color: #0000FF">11360000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 534</span> <a name="Line534"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">            memberindexhh = <a href="file12.html">randomsample</a>(w(hhindexh,:),rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 19.31 </span></pre></td><td><pre><span style="color: #0000FF">11360000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 535</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            size4data_to_check(m,33+hh) = memberindexhh; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 536</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            % generating individual level data</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 17.78 </span></pre></td><td><pre><span style="color: #0000FF">11360000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 537</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for j = 1:p </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 242.42 </span></pre></td><td><pre><span style="color: #0000FF">56800000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 538</span> <a name="Line538"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                phimj = reshape(phi((hhindexh-1)*L+memberindexhh,j,1:d(j)),1,d(j)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 817.77 </span></pre></td><td><pre><span style="color: #0000FF">56800000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 539</span> <a name="Line539"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FF8080; padding:1px;">                syn(hh,j) = <a href="file12.html">randomsample</a>(phimj,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 92.12 </span></pre></td><td><pre><span style="color: #0000FF">56800000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 540</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 17.62 </span></pre></td><td><pre><span style="color: #0000FF">11360000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 541</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 542</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        % generating household level data</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  5.54 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 543</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        lambda1mj = lambda1(hhindexh,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 42.62 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 544</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        syn(:,p+1) = <a href="file12.html">randomsample</a>(lambda1mj,rand); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000"> 141.72 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 545</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">        syn_sorted = <a href="file14.html">sortrows</a>(syn,5); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  9.43 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 546</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,3:8) = syn_sorted(1,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  7.68 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 547</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,11:16) = syn_sorted(2,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  7.75 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 548</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,19:24) = syn_sorted(3,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  8.02 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 549</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,27:32) = syn_sorted(4,:); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.44 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 550</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,1) = m + (size2number_of_generation+size3number_of_generation+size4number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.40 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 551</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,9) = m + (size2number_of_generation+size3number_of_generation+size4number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.89 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 552</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,17) = m + (size2number_of_generation+size3number_of_generation+size4number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.37 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 553</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,25) = m + (size2number_of_generation+size3number_of_generation+size4number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.04 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 554</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,2) = 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.05 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 555</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,10) = 2; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.71 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 556</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,18) = 3; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.18 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 557</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        size4data_to_check(m,26) = 4; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.15 </span></pre></td><td><pre><span style="color: #0000FF">2840000 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 558</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 559</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 560</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % transpose the data to check</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.38 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 561</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4data_to_checkT = size4data_to_check(:,1:32)'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 562</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %toc   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 563</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %mex checkingconstraints_new.cpp       </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.34 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 564</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4outcome1 = <a href="file17.html">checkingconstraints_size4_sorted_part1</a>(size4data_to_checkT,10000); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.21 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 565</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4outcome2 = <a href="file18.html">checkingconstraints_size4_sorted_part2</a>(size4data_to_checkT,10000); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.24 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 566</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4outcome3 = <a href="file19.html">checkingconstraints_size4_sorted_part3</a>(size4data_to_checkT,10000); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 567</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4outcome = size4outcome1+size4outcome2+size4outcome3; </span><br/></pre></td></tr><tr><a name="Line568"></a><td><pre><span style="color: #FF0000"> 14.84 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 568</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4startindex1 = min(find(size4data_to_check_all(:,1)==0)); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 569</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    % startindex2 = min(find(outcome_to_save==0));</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 570</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4startindex2 = (size4number_of_generation-1)*10000 + 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.17 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 571</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4data_to_check_all(size4startindex1:size4startindex1+10000-1,:) = size4data_to_check; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 572</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4outcome_to_save(size4startindex2:(size4startindex2+10000-1)) = size4outcome; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 573</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %sum(outcome)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  2.21 </span></pre></td><td><pre><span style="color: #0000FF">    284 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 574</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 575</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><a name="Line576"></a><td><pre><span style="color: #FF0000">  0.79 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 576</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    syndatao_size4_old = size4data_to_check_all(find(size4outcome_to_save==1),:); </span><br/></pre></td></tr><tr><a name="Line577"></a><td><pre><span style="color: #FF0000"> 25.38 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 577</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size4_old2 = size4data_to_check_all(find(size4outcome_to_save==0),:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 578</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">   </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 579</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    syndatao_size4 = syndatao_size4_old(1:ACSsize4_count,:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 580</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4exceeding_index = syndatao_size4(ACSsize4_count,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 581</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><a name="Line582"></a><td><pre><span style="color: #FF0000">  0.85 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 582</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    while (isempty(find(extras_size4_old2(:,1)==size4exceeding_index))==1) </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     26 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 583</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    	size4exceeding_index = size4exceeding_index - 1; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.83 </span></pre></td><td><pre><span style="color: #0000FF">     26 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 584</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 585</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size4exceeding_index = size4exceeding_index-(1+size2number_of_generation+size3number_of_generation)*10000; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.34 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 586</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size4_old1 = size4data_to_check_all(1:size4exceeding_index,:); </span><br/></pre></td></tr><tr><a name="Line587"></a><td><pre><span style="color: #FF0000">  0.36 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 587</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size4_old = extras_size4_old1(find(size4outcome_to_save(1:size4exceeding_index)==0),:); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 588</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 589</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size_extras_size4_old_1 = size(extras_size4_old); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 590</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    size_extras_size4_old = size_extras_size4_old_1(1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 591</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.14 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 592</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    extras_size4 = zeros(4*size_extras_size4_old,8+2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 593</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for s = 1:size_extras_size4_old </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  8.48 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 594</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+1,1:8) = extras_size4_old(s,1:8); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  8.00 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 595</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+2,1:8) = extras_size4_old(s,9:16); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  8.49 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 596</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+3,1:8) = extras_size4_old(s,17:24); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  8.78 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 597</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+4,1:8) = extras_size4_old(s,25:32); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  6.79 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 598</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4((4*(s-1)+1):4*s,9) = extras_size4_old(s,33); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.31 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 599</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+1,10) = extras_size4_old(s,34); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.76 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 600</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+2,10) = extras_size4_old(s,35); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.31 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 601</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+3,10) = extras_size4_old(s,36); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  3.81 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 602</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        extras_size4(4*(s-1)+4,10) = extras_size4_old(s,37); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  4.26 </span></pre></td><td><pre><span style="color: #0000FF">2639941 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 603</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 604</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 605</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 606</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %%    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 607</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %truesyndatao = syndatao(1:min(find(syndatao(:,1)==0))-1,:);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 608</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %toc</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 609</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    disp('synthesis updated'); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 610</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 611</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">       %syndata{i} = syndatao;</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 612</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       if (mod(i,thin) == 0 &amp;&amp; i &gt; burn)  </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      5 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 613</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       piout((i-burn)/thin,:) = pi'; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      5 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 614</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       wout((i-burn)/thin,:,:) = w; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">      5 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 615</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       newphiout((i-burn)/thin,:,:) = newphi; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      5 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 616</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       lambda1out((i-burn)/thin,:,:) = lambda1; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      5 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 617</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       lambda2out((i-burn)/thin,:,:) = lambda2; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      5 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 618</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       end </span><br/></pre></td></tr><tr><a name="Line619"></a><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 619</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       i </span><br/></pre></td></tr><tr><a name="Line620"></a><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 620</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       n_new </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 621</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       toc </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 622</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       elapsed_time(i) = toc; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 623</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       n_sout(i) = n_s_new; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 624</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       nout(i) = n_new; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 625</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       size2extrasize(i) = size_extras_size2_old; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 626</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       size3extrasize(i) = size_extras_size3_old; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 627</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       size4extrasize(i) = size_extras_size4_old; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 628</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       z_HH_save(i,1:n_s) = z_HH_all; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 629</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       z_member_save(i,1:n_s) = z_member; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 630</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       alphaout(i) = alpha; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 631</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       betaout(i) = beta; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 632</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">       disp('saving done');  </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">     25 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 633</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 634</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 635</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">HHindex = <a href="file1.html">unique</a>(ACSdatasample(:,1));  </span><br/></pre></td></tr><tr><a name="Line636"></a><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 636</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">SSorig = <a href="file4.html">hist</a>(ACSdatasample(:,1),HHindex);  </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 637</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      1 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 638</span> </pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">toc     </span><br/></pre></td></tr></table></body></html>